export default function imageViewer(){let e=!1,t=1,n=!1,r=!1,o=0,i=0,a=0,s=0,c=0;const d=document.querySelector(".image-viewer-container");if(!d)return void console.warn("Image viewer container not found. Exiting imageViewer function.");const l=d.querySelector("img");if(!l)return void console.warn("Target image not found in image viewer container. Exiting imageViewer function.");const showHandle=e=>{document.body.style.overflow=e?"hidden":"auto",e?d.classList.add("active"):d.classList.remove("active")};let m=0;const dragEndHandle=e=>{n&&e.stopPropagation(),n=!1,l.style.cursor="grab"};l.addEventListener("wheel",(e=>{e.preventDefault();const n=l.getBoundingClientRect(),r=e.clientX-n.left,o=e.clientY-n.top,i=r-n.width/2,a=o-n.height/2,d=t;t+=-.001*e.deltaY,t=Math.min(Math.max(.8,t),4),d<t?(s-=i*(t-d),c-=a*(t-d)):(s=0,c=0),l.style.transform=`translate(${s}px, ${c}px) scale(${t})`}),{passive:!1}),l.addEventListener("mousedown",(e=>{e.preventDefault(),n=!0,i=e.clientX,a=e.clientY,l.style.cursor="grabbing"}),{passive:!1}),l.addEventListener("mousemove",(e=>{if(n){const n=(new Date).getTime();if(n-m<100)return;m=n;const o=e.clientX-i,d=e.clientY-a;s+=o,c+=d,i=e.clientX,a=e.clientY,l.style.transform=`translate(${s}px, ${c}px) scale(${t})`,r=!0}}),{passive:!1}),l.addEventListener("mouseup",dragEndHandle,{passive:!1}),l.addEventListener("mouseleave",dragEndHandle,{passive:!1}),d.addEventListener("click",(n=>{r||(e=!1,showHandle(e),t=1,s=0,c=0,l.style.transform=`translate(${s}px, ${c}px) scale(${t})`),r=!1}));const u=document.querySelectorAll(".markdown-body img:not(.img-preloader-loaded), .masonry-item img:not(.img-preloader-loaded), #shuoshuo-content img:not(.img-preloader-loaded)"),g=[];u.forEach((e=>{g.push({element:e,getSrc:()=>e.dataset.originalSrc||e.src})}));const escapeKeyListener=n=>{"Escape"===n.key&&e&&(e=!1,showHandle(e),t=1,s=0,c=0,l.style.transform=`translate(${s}px, ${c}px) scale(${t})`,document.removeEventListener("keydown",escapeKeyListener))},observeNewImages=()=>{document.querySelectorAll(".markdown-body .img-preloader-loaded, .masonry-item .img-preloader-loaded, #shuoshuo-content .img-preloader-loaded").forEach((t=>{if(!g.some((e=>e.element===t))){const n=g.length;g.push({element:t,getSrc:()=>t.dataset.originalSrc||t.src}),t.addEventListener("click",(()=>{o=n,e=!0,showHandle(e),l.src=t.dataset.originalSrc||t.src,document.addEventListener("keydown",escapeKeyListener)}))}}))};if(g.length>0||document.querySelector(".img-preloader")){g.forEach(((t,n)=>{t.element.addEventListener("click",(()=>{o=n,e=!0,showHandle(e),l.src=t.getSrc(),document.addEventListener("keydown",escapeKeyListener)}))}));const handleArrowKeys=t=>{if(e){if("ArrowUp"===t.key||"ArrowLeft"===t.key)o=(o-1+g.length)%g.length;else{if("ArrowDown"!==t.key&&"ArrowRight"!==t.key)return;o=(o+1)%g.length}l.src=g[o].getSrc()}};document.addEventListener("keydown",handleArrowKeys);new MutationObserver(observeNewImages).observe(document.body,{childList:!0,subtree:!0}),setInterval(observeNewImages,1e3)}}
//# sourceMappingURL=imageViewer.js.map