!function(){const e="giscus-session",t=document.currentScript,s=t.dataset.giscusOrigin||"https://giscus.app";function formatError(e){return`[giscus] An error occurred. Error message: "${e}".`}function getMetaContent(e,t=!1){const s=t?`meta[property='og:${e}'],`:"",o=document.querySelector(s+`meta[name='${e}']`);return o?o.content:""}const o=new URL(location.href);let i=o.searchParams.get("giscus")||"";const n=localStorage.getItem(e);o.searchParams.delete("giscus"),o.hash="";const r=o.toString();if(i)localStorage.setItem(e,JSON.stringify(i)),history.replaceState(void 0,document.title,r),window.dispatchEvent(new CustomEvent("giscus:session-change",{detail:{session:i}}));else if(n)try{i=JSON.parse(n)}catch(t){localStorage.removeItem(e),console.warn(`${formatError(t?.message)} Session has been cleared.`)}const c=t.dataset,a={};switch(a.origin=r,a.session=i,a.theme=c.theme,a.reactionsEnabled=c.reactionsEnabled||"1",a.emitMetadata=c.emitMetadata||"0",a.inputPosition=c.inputPosition||"bottom",a.repo=c.repo,a.repoId=c.repoId,a.category=c.category||"",a.categoryId=c.categoryId,a.strict=c.strict||"0",a.description=getMetaContent("description",!0),a.backLink=getMetaContent("giscus:backlink")||r,c.mapping){case"url":a.term=r;break;case"title":a.term=document.title;break;case"og:title":a.term=getMetaContent("title",!0);break;case"specific":a.term=c.term;break;case"number":a.number=c.term;break;default:a.term=location.pathname.length<2?"index":decodeURIComponent(location.pathname.substring(1).replace(/\.\w+$/,""))}const l=document.querySelector(".giscus"),g=l&&l.id;g&&(a.origin=`${r}#${g}`);const d=c.lang?`/${c.lang}`:"",u=`${s}${d}/widget?${new URLSearchParams(a)}`,m="lazy"===c.loading?"lazy":void 0,p=document.createElement("iframe"),f={class:"giscus-frame giscus-frame--loading",title:"Comments",scrolling:"no",allow:"clipboard-write",src:u,loading:m};if(Object.entries(f).forEach((([e,t])=>t&&p.setAttribute(e,t))),p.style.opacity="0",p.addEventListener("load",(()=>{p.style.removeProperty("opacity"),p.classList.remove("giscus-frame--loading")})),!document.getElementById("giscus-css")){const e=document.createElement("style");e.id="giscus-css",e.textContent=".giscus,.giscus-frame{width:100%;min-height:150px}.giscus-frame{border:none;color-scheme:light dark}.giscus-frame--loading{opacity:0}",document.head.prepend(e)}if(l){for(;l.firstChild;)l.firstChild.remove();l.appendChild(p)}else{const e=document.createElement("div");e.setAttribute("class","giscus"),e.appendChild(p),t.insertAdjacentElement("afterend",e)}const h="Please consider reporting this error at https://github.com/giscus/giscus/issues/new.",w="giscus-scroll-position";if(window.addEventListener("beforeunload",(()=>{sessionStorage.setItem(w,String(window.scrollY))})),i&&!n){const e=sessionStorage.getItem(w);if(e){sessionStorage.removeItem(w);const t=parseInt(e,10);!isNaN(t)&&t>0&&requestAnimationFrame((()=>{window.scrollTo({top:t,behavior:"instant"})}))}}let b=-1,y=null;function signOut(){delete a.session;const e=`${s}${d}/widget?${new URLSearchParams(a)}`;p.src=e}window.addEventListener("message",(t=>{if(t.origin!==s)return;const{data:o}=t;if("object"!=typeof o||!o.giscus)return;if(o.giscus.resizeHeight&&(p.style.height=`${o.giscus.resizeHeight}px`),o.giscus.discussion&&"number"==typeof o.giscus.discussion.totalCommentCount){const e=o.giscus.discussion.totalCommentCount;b>=0&&e>b&&(clearTimeout(y),y=setTimeout((()=>{p.isConnected&&p.contentWindow&&p.contentWindow.postMessage({giscus:{setConfig:{term:a.term}}},s)}),3e3)),b=e}if(o.giscus.signOut)return localStorage.removeItem(e),console.log("[giscus] User has logged out. Session has been cleared."),void signOut();if(!o.giscus.error)return;const r=o.giscus.error;r.includes("Bad credentials")||r.includes("Invalid state value")||r.includes("State has expired")?null!==localStorage.getItem(e)?(localStorage.removeItem(e),console.warn(`${formatError(r)} Session has been cleared.`),signOut()):n||console.error(`${formatError(r)} No session is stored initially. ${h}`):r.includes("Discussion not found")?(console.warn(`[giscus] ${r}. A new discussion will be created if a comment/reaction is submitted.`),i&&(clearTimeout(y),y=setTimeout((()=>{p.isConnected&&p.contentWindow&&p.contentWindow.postMessage({giscus:{setConfig:{term:a.term}}},s)}),5e3))):r.includes("API rate limit exceeded")?console.warn(formatError(r)):console.error(`${formatError(r)} ${h}`)})),window.__giscus={signOut:signOut,setConfig(e){p.contentWindow?.postMessage({giscus:{setConfig:e}},s)},refresh(){p.contentWindow?.postMessage({giscus:{setConfig:{term:a.term}}},s)},reload(){p.src=u}}}();
//# sourceMappingURL=giscus-client.source.js.map