{"version":3,"file":"masonry-reactions.source.js","names":["GISCUS_SESSION_KEY","GISCUS_ORIGIN","GITHUB_GRAPHQL_API","CACHE_KEY_PREFIX","CACHE_TTL","MASONRY_SCROLL_KEY","PENDING_HEART_KEY","currentPagePath","imageReactions","userToken","isAuthenticated","isInitialized","swupHooked","getPageConfig","el","document","getElementById","JSON","parse","textContent","getGiscusApiBase","config","giscusProxy","async","getGiscusToken","raw","localStorage","getItem","session","apiBase","res","fetch","method","headers","body","encodeURIComponent","ok","json","token","getGiscusLoginUrl","redirectUri","location","href","fetchFromGiscusAPI","repo","term","category","first","after","params","URLSearchParams","number","strict","String","set","status","console","warn","err","fetchAllComments","firstPage","discussion","allComments","comments","pageInfo","hasNextPage","endCursor","nextPage","push","checkViewerReactions","commentIds","length","result","i","batch","slice","aliases","map","id","j","join","Authorization","stringify","query","data","errors","node","reactionGroups","heart","find","g","content","viewerHasReacted","toggleHeartReaction","commentId","hasReacted","mode","variables","subjectId","parseImageId","bodyHTML","match","trim","getCacheKey","getCache","sessionStorage","cached","Date","now","timestamp","removeItem","setCache","setItem","clearCache","createHeartButton","imageId","btn","createElement","className","dataset","setAttribute","innerHTML","addEventListener","handleHeartClick","initializeHeartButtons","imageIds","items","querySelectorAll","imageIdSet","Set","forEach","container","querySelector","src","preloader","getAttribute","img","findImageIdFromSrc","classList","contains","add","appendChild","srcBase","decodeURIComponent","split","replace","idBase","includes","endsWith","updateHeartButton","heartCount","CSS","escape","countEl","reacted","toggle","applyReactions","comment","reactions","HEART","count","applyCachedReactions","Object","entries","e","preventDefault","stopPropagation","currentTarget","window","scrollY","clickedImageId","reaction","currentlyReacted","currentCount","newCount","Math","max","newReacted","success","remove","discussionTerm","init","newPagePath","pendingHeart","savedScroll","parseInt","isNaN","requestAnimationFrame","scrollTo","top","behavior","fetchAndApplyLive","handlePendingHeart","setTimeout","click","values","r","filter","Boolean","viewerReactions","cleanup","onPageView","tryRegisterSwup","s","eval","hooks","on","key","newValue","then","event","origin","giscus","signOut","syncOAuthSession","giscusParam","URL","searchParams","get","readyState","attempts","pollInterval","setInterval","clearInterval"],"sources":["0"],"mappings":"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","ignoreList":[]}