{"version":3,"file":"masonry-reactions.source.js","names":["GISCUS_SESSION_KEY","GISCUS_ORIGIN","GITHUB_GRAPHQL_API","CACHE_KEY_PREFIX","CACHE_TTL","MASONRY_SCROLL_KEY","PENDING_HEART_KEY","currentPagePath","imageReactions","userToken","isAuthenticated","isInitialized","swupHooked","getPageConfig","el","document","getElementById","JSON","parse","textContent","getGiscusApiBase","config","giscusProxy","async","getGiscusToken","raw","localStorage","getItem","session","apiBase","res","fetch","method","headers","body","encodeURIComponent","ok","json","token","getGiscusLoginUrl","redirectUri","location","href","fetchFromGiscusAPI","repo","term","category","first","after","params","URLSearchParams","number","strict","String","set","status","console","warn","err","fetchAllComments","firstPage","discussion","allComments","comments","pageInfo","hasNextPage","endCursor","nextPage","push","checkViewerReactions","commentIds","length","result","i","batch","slice","aliases","map","id","j","join","Authorization","stringify","query","data","errors","node","reactionGroups","heart","find","g","content","viewerHasReacted","toggleHeartReaction","commentId","hasReacted","mode","variables","subjectId","parseImageId","match","trim","getCacheKey","getCache","sessionStorage","cached","Date","now","timestamp","removeItem","setCache","setItem","clearCache","createHeartButton","imageId","btn","createElement","className","dataset","setAttribute","innerHTML","addEventListener","handleHeartClick","initializeHeartButtons","imageIds","items","querySelectorAll","imageIdSet","Set","forEach","container","querySelector","src","preloader","getAttribute","img","findImageIdFromSrc","classList","contains","add","appendChild","srcBase","decodeURIComponent","split","replace","idBase","includes","endsWith","updateHeartButton","heartCount","CSS","escape","countEl","reacted","toggle","applyReactions","previous","comment","bodyHTML","reactions","HEART","count","preservedViewerHasReacted","existing","applyCachedReactions","Object","entries","e","preventDefault","stopPropagation","currentTarget","window","scrollY","clickedImageId","reaction","currentlyReacted","currentCount","newCount","Math","max","newReacted","success","remove","discussionTerm","init","newPagePath","pendingHeart","savedScroll","parseInt","isNaN","requestAnimationFrame","scrollTo","top","behavior","fetchAndApplyLive","handlePendingHeart","setTimeout","click","values","r","filter","Boolean","viewerReactions","cleanup","onPageView","tryRegisterSwup","s","eval","hooks","on","refreshAuthenticatedState","key","newValue","event","origin","giscus","signOut","syncOAuthSession","giscusParam","URL","searchParams","get","readyState","attempts","pollInterval","setInterval","clearInterval"],"sources":["0"],"mappings":"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","ignoreList":[]}